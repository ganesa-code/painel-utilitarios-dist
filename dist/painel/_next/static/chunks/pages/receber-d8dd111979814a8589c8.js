_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[32],{"1ssf":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/receber",function(){return t("IxYm")}])},IxYm:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return b}));var n=t("nKUr"),r=t("vJKn"),s=t.n(r),c=t("rg98"),i=t("r9w1"),l=t("Z3vd"),o=t("YMtY"),d=t("q1tI"),u=t("bFzY"),O=t("FGyW"),E=t("tRs7"),h=t("Dp36"),m=t("uc1H"),f=t.n(m),C=(t("jDDT"),t("UN6+")),N=new E.a;function b(){var e=Object(d.useState)(),a=e[0],t=e[1],r=Object(d.useState)(),E=r[0],m=r[1],b=Object(d.useState)(),p=b[0],j=b[1],g=Object(d.useState)(!1),A=g[0],S=g[1],v=Object(d.useState)(),T=v[0],_=v[1],w=Object(d.useState)(),D=w[0],M=w[1],R=Object(d.useState)([]),I=R[0],L=R[1],x=Object(d.useState)(0),V=x[0],P=x[1],y=Object(d.useState)(0),k=y[0],B=y[1],Y=Object(u.c)(),G=Y.filialPrincipal,F=Y.user,H=Object(d.useRef)(null);Object(d.useEffect)((function(){p&&h.a.get("/receber/".concat(G.CODEMPRESA,"/").concat(p.CODCLIENTE)).then((function(e){var a=e.data.receber.map((function(e){return{id:e.CODDOCTO.trim(),CODEMPRESA:"".concat(e.CODEMPRESA," - ").concat(e.NOMEEMPRESA.split(" ")[0]),NOME:"".concat(e.CODCLIENTE," - ").concat(e.NOME),EMAIL:e.EMAIL,DATAEMISSAO:K(e.DT_EMISSAO),DATAVENCIMENTO:K(e.DT_VENCIMENTO),VALORTOTAL:z(e.VALORDOCTO-e.VALORDESC),VALORPAGO:z(e.VALORPAGO),OBSERVACAO:e.OBSERVACAO.trim(),unparsedValorTotalSelecionado:e.VALORDOCTO-e.VALORDESC,unparsedValorPagoSelecionado:e.VALORPAGO,TIPODOCTO:e.TIPODOCTO}}));_([{field:"id",headerName:"Documento",width:150,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"TIPODOCTO",headerName:"Tipo",width:100,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"CODEMPRESA",headerName:"Empresa",width:150,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"NOME",headerName:"Cliente",width:300,headerClassName:"header-data-grid",cellClassName:"cell-data-grid",resizable:!0},{field:"DATAEMISSAO",headerName:"Data Emiss\xe3o",width:150,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"DATAVENCIMENTO",headerName:"Data Vencimento",width:180,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"VALORTOTAL",headerName:"Total",width:120,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"VALORPAGO",headerName:"Pago",width:120,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"},{field:"OBSERVACAO",headerName:"Observa\xe7\xe3o",width:290,headerClassName:"header-data-grid",cellClassName:"cell-data-grid"}]),M(a)}))}),[p]),Object(d.useEffect)((function(){window.addEventListener("mousedown",J)}),[]),Object(d.useEffect)((function(){if(D&&D.length>1){var e=D.reduce((function(e,a){return e+(+a.unparsedValorTotalSelecionado-+a.unparsedValorPagoSelecionado)}),0);B(e)}}),[D]),Object(d.useEffect)((function(){var e=I.reduce((function(e,a){return e+(+a.unparsedValorTotalSelecionado-+a.unparsedValorPagoSelecionado)}),0);P(e)}),[I]);var J=function(e){var a;H&&"NOMECLIENTE"===e.target.name?S(!0):!H||null!==(a=H.current)&&void 0!==a&&a.contains(e.target)||S(!1)},K=function(e){return null===e?"":new Date(e).toLocaleString().split(" ")[0]},z=function(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})},U=function(){var e=Object(c.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(I.length<1)){e.next=3;break}return N.notify("Selecione ao menos um documento para enviar e-mail","warning"),e.abrupt("return");case 3:return e.prev=3,a={EMAIL:p.EMAIL,NOME:p.NOME,valorTotalSelecionado:V,documentos:I},e.next=7,h.a.post("/receber/".concat(G.CODEMPRESA),a);case 7:e.sent,N.notify("E-mail enviado com sucesso!","success"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),N.notify(e.t0.res.data.message,"error");case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)("div",{className:"wrapper",children:"SEM_ACESSO"!==(null===F||void 0===F?void 0:F.permissions.contasAReceber)?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(O.a,{}),Object(n.jsx)("h2",{children:"Contas a Receber"}),Object(n.jsxs)("div",{className:f.a.clienteInput,children:[Object(n.jsx)(i.a,{label:"Cliente",name:"NOMECLIENTE",autoComplete:"off",variant:"outlined",value:a,color:"primary",onChange:function(e){return a=e,S(!0),t(a.target.value),void(a.target.value.length>1?h.a.post("/clientes",{search:a.target.value}).then((function(e){m(e.data.parsedClientes)})):(S(!1),m([])));var a}}),E&&Object(n.jsx)("div",{ref:H,className:"".concat(f.a.searchResult," ").concat(A?f.a.visible:f.a.invisible),children:E.map((function(e){return Object(n.jsx)("span",{onClick:function(){t(e.CODCLIENTE+" - "+e.NOME),j(e),S(!1)},children:e.CODCLIENTE+" - "+e.NOME},e.CODCLIENTE)}))})]}),p&&T&&D&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(l.a,{variant:"contained",color:"primary",disabled:"ACESSO_TOTAL"!==(null===F||void 0===F?void 0:F.permissions.contasAReceber),style:{backgroundColor:"#B23237",color:"#f4f4f4",width:"fit-content",margin:"0rem auto 1rem 0"},onClick:U,children:"Enviar E-mails"}),Object(n.jsx)(o.a,{autoHeight:!0,rows:D,columns:T,pageSize:15,checkboxSelection:!0,disableSelectionOnClick:!0,rowsPerPageOptions:[25,50,100],onSelectionModelChange:function(e){var a=new Set(e.selectionModel);L(D.filter((function(e){return a.has(e.id)})))}}),Object(n.jsxs)("span",{className:f.a.totais,children:[Object(n.jsx)("strong",{children:"Total dos documentos: "})," ",z(k)]}),Object(n.jsxs)("span",{className:f.a.totais,children:[Object(n.jsx)("strong",{children:"Total selecionado: "})," ",z(V)]})]})]}):Object(n.jsx)(C.a,{})})}},uc1H:function(e,a,t){e.exports={invisible:"styles_invisible__3BKms",visible:"styles_visible__2UgTb",totais:"styles_totais__HYkmE",produtoInput:"styles_produtoInput__2JZ9j",clienteInput:"styles_clienteInput__xlKYb",searchResult:"styles_searchResult__1E113"}}},[["1ssf",0,1,4,7,10,3,2,5,6,8,11]]]);